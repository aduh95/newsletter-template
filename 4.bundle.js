(window.webpackJsonp=window.webpackJsonp||[]).push([[4,15],{25:function(e,t,n){"use strict";n.d(t,"a",function(){return a});var s=n(0),i=n(26);function r(){return(r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e}).apply(this,arguments)}const o=new(n.n(i).a);class a extends s.a{constructor(...e){var t,n,s;super(...e),s={loading:!0},(n="state")in(t=this)?Object.defineProperty(t,n,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[n]=s}static translate(e){let t;const n=new Promise(e=>t=e),s=function(e,t,n){if(e!==t)throw new TypeError("Private static access of wrong provenance");return n.value}(this,a,l).then(()=>new Promise((t,n)=>{o.onmessage=({data:e})=>{t(e)},o.onmessageerror=n,o.onerror=n,o.postMessage(e)})).finally(t);return function(e,t,n,s){if(e!==t)throw new TypeError("Private static access of wrong provenance");if(!n.writable)throw new TypeError("attempted to set read only private field");n.value=s}(this,a,l,n),s}componentDidMount(){this.translate()}componentDidUpdate(e){e.content!==this.props.content&&this.translate()}translate(){this.constructor.translate(this.props.content).then(e=>{this.setState({loading:!1,html:e})}).catch(e=>{console.error(e),this.setState({loading:!1,html:"<div data-ignore class='error'>Error when rendering markdown content</div>"})})}render(){return this.state.loading?Object(s.h)("p",{"data-ignore":!0},"Loading..."):Object(s.h)("output",r({"data-contents":!0,dangerouslySetInnerHTML:{__html:this.state.html}},this.props.attributes))}}var l={writable:!0,value:Promise.resolve()}},26:function(e,t,n){e.exports=function(){return new Worker(n.p+"25e8b5bb6f306b1d55e5.worker.js")}},28:function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return r});var s=n(0),i=n(30);class r extends s.a{handleDrag({currentTarget:e},t){const n=Array.from(e.parentNode.children),s=n.indexOf(e),i=n.indexOf(t);this.props.handleReOrder(s,i)}render(){const e=this.props.content||[];return Object(s.h)("ol",{className:"ordered-list"},e.concat([{}]).map(({label:t,href:n},r)=>Object(s.h)("li",{draggable:r<e.length,onDragStart:Object(i.a)(this.handleDrag.bind(this)),key:r},Object(s.h)("input",{name:"label",value:t||"",placeholder:"Link label",onChange:e=>this.props.handleChange(e,r)}),Object(s.h)("input",{name:"href",value:n||"",placeholder:"Link URL",onChange:e=>this.props.handleChange(e,r),type:"url"}))))}}},30:function(e,t,n){"use strict";n.d(t,"b",function(){return r});const s="drop-candidate-for-reordering",i=[],r=e=>{document.body.addEventListener("dragover",e),i.push(e)};t.a=e=>t=>{const{target:n}=t,{parentElement:r}=n;let o,a,l;t.dataTransfer.effectAllowed="move",r.style.setProperty("--dragged-element-height",n.offsetHeight+"px");for(const e of i)document.body.removeEventListener("dragover",e);r.classList.add(s);const c=()=>{var e;l=null,null===(e=r.querySelector("."+s))||void 0===e||e.classList.remove(s),o?(n.classList.remove("to-be-deleted"),o!==n&&o.classList.add(s)):n.classList.add("to-be-deleted")},h=e=>{e.stopPropagation(),e.preventDefault(),o=e.currentTarget,l||(l=requestAnimationFrame(c))},d=e=>{e.preventDefault(),o=null,l||(l=requestAnimationFrame(c))},u=e=>{e.stopPropagation(),e.preventDefault(),a=e.currentTarget},p=e=>{e.preventDefault(),a=null};Array.from(r.children,e=>{e.addEventListener("drop",u),e.addEventListener("dragover",h)}),document.body.addEventListener("dragover",d),document.body.addEventListener("drop",p),n.addEventListener("dragend",t=>{Array.from(document.getElementsByClassName(s),e=>e.classList.remove(s)),document.body.removeEventListener("dragover",d),document.body.removeEventListener("drop",p);for(const e of r.children)e.removeEventListener("drop",u),e.removeEventListener("dragover",h);for(const e of i)document.body.addEventListener("dragover",e);void 0!==a&&e(t,a)},{once:!0,passive:!0})}},33:function(e,t,n){"use strict";const s="HTMLDialogElement"in window;t.a=e=>s?Promise.resolve():Promise.all([n.e(25).then(n.bind(null,39)),n.e(17).then(n.t.bind(null,40,7))]).then(t=>t[0].default.registerDialog(e))},36:function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return l});var s=n(0),i=n(28),r=n(41),o=n(33);class a extends s.a{static getDerivedStateFromProps({src:e}){return{noIllustration:!e}}disableIllustration(e){this.props.onChange({src:void 0,alt:void 0,isVideo:void 0})}switchToVideo(e){this.props.onChange({src:"about:blank",alt:void 0,isVideo:!0}),requestAnimationFrame(()=>e.target.form.elements.src.focus())}switchToImage(e){this.props.onChange({src:"about:blank",alt:"",isVideo:!1}),requestAnimationFrame(()=>e.target.form.elements.src.focus())}handleChange(e){const{target:t}=e,{name:n,value:s}=t;this.props.onChange({...this.props,[n]:s})}render(){return Object(s.h)("fieldset",null,Object(s.h)("legend",null,"Illustration"),"Illustration type: ",Object(s.h)("label",null,Object(s.h)("input",{onChange:this.disableIllustration.bind(this),name:"isVideo",type:"radio",value:"noIllustration",checked:this.state.noIllustration})," No illustration"),Object(s.h)("label",null,Object(s.h)("input",{onChange:this.switchToImage.bind(this),name:"isVideo",type:"radio",value:"false",checked:!this.state.noIllustration&&!this.props.isVideo})," Image"),Object(s.h)("label",null,Object(s.h)("input",{onChange:this.switchToVideo.bind(this),name:"isVideo",type:"radio",value:"true",checked:!this.state.noIllustration&&this.props.isVideo})," Video"),this.state.noIllustration?null:Object(s.h)("label",null,this.props.isVideo?"Video":"Image"," URL: ",Object(s.h)("input",{onChange:this.handleChange.bind(this),name:"src",type:"url",value:this.props.src})),this.state.noIllustration||this.props.isVideo?null:Object(s.h)("label",null,"Image description: ",Object(s.h)("input",{onChange:this.handleChange.bind(this),name:"alt",value:this.props.alt,placeholder:"Mandatory description of the image",required:!0})))}}class l extends s.a{constructor(...e){var t,n,i;super(...e),t=this,n="dialog",i=Object(s.g)(),n in t?Object.defineProperty(t,n,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[n]=i}componentWillMount(){const{type:e,title:t,description:n,links:s}=this.props;this.setState({type:e,title:t,description:n,isMain:!!this.props.isMain,isVideo:!!this.props.isVideo,illustration:this.props.illustration||null,illustrationDescription:this.props.illustrationDescription,links:s})}componentDidMount(){this.update()}componentDidUpdate(e){this.update(e)}update(e={}){const{current:t}=this.dialog;if(Object(o.a)(t).then(()=>t&&!t.open&&t.showModal()),t&&e.focus!==this.props.focus){const e=this.props.focus,n=null==e?void 0:e.match(/^(.+)\[(\d+)\]$/),s=n?t.querySelectorAll(`[name=${n[1]}]`).item(n[2]):t.querySelector(`[name=${e}]`);s&&requestAnimationFrame(()=>{if(this.props.focusOffset){let e=this.props.focusText?s.value.indexOf(this.props.focusText,this.props.focusOffset[0])-this.props.focusOffset[0]:0;s.setSelectionRange(...this.props.focusOffset.map(t=>t+e))}s.focus()})}}handleChange(e,t){const{name:n,value:s}=e.target,{links:i}=this.state;t===i.length?i.push({[n]:s}):i[t][n]=s,this.setState({links:i})}handleSubmit(){const e={...this.state};Array.isArray(this.state.links)&&(e.links=this.state.links.filter(({label:e,href:t})=>e||t).map(({label:e,href:t})=>({label:e||"[Link]",href:t||"about:blank"}))),requestIdleCallback(()=>this.props.saveState(e))}handleReOrder(e,t){const n=this.state.links;let s=[];-1===t?s=s.concat(n.slice(0,e),n.slice(e+1)):e<t?s=s.concat(n.slice(0,e),n.slice(e+1,t),n.slice(e,1),n.slice(t)):e>t&&(s=s.concat(n.slice(0,t),n.slice(e,e+1),n.slice(t,e),n.slice(e+1))),e!==t&&this.setState({links:s})}onReset(e){e.stopPropagation(),this.props.resetState()}render(){return Object(s.h)("dialog",{"data-ignore":!0,onClose:this.onReset.bind(this),onClick:e=>e.stopPropagation(),ref:this.dialog},Object(s.h)("form",{method:"dialog",onSubmit:this.handleSubmit.bind(this)},Object(s.h)("div",null,Object(s.h)("label",null,"Title: ",Object(s.h)("input",{name:"title",value:this.state.title,onChange:e=>this.setState({title:e.target.value})})),Object(s.h)("label",null,"Featured article: ",Object(s.h)("input",{name:"isMain",checked:this.state.isMain,type:"checkbox",onChange:e=>this.setState({isMain:e.target.checked})})),Object(s.h)(a,{isVideo:this.state.isVideo,src:this.state.illustration,alt:this.state.illustrationDescription,onChange:({isVideo:e,src:t,alt:n})=>this.setState({isVideo:e,illustration:t,illustrationDescription:n})}),Object(s.h)("label",null,"Text: ",Object(s.h)(r.a,{name:"description",value:this.state.description,onChange:e=>this.setState({description:e.target.value}),initiallyActive:"description"===this.props.focus})),Object(s.h)(i.default,{content:this.state.links,handleChange:this.handleChange.bind(this),handleReOrder:this.handleReOrder.bind(this)}),Object(s.h)("button",{type:"submit"},"Save"),Object(s.h)("button",{type:"reset",onClick:this.onReset.bind(this)},"Cancel"))))}}},41:function(e,t,n){"use strict";n.d(t,"a",function(){return g});var s=n(0),i=n(31),r=n(32),o=n(25),a=n(42);function l(){return(l=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e}).apply(this,arguments)}function c(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const h=new(n.n(a).a),d=[{label:r.a,char:"**",shortcut:"b"},{label:r.d,char:"_",shortcut:"i"},{label:r.f,charAfter:"\n\n- ",selectionAfter:!0},{label:r.e,charBefore:"[",charAfter:"](https://)",selectionAfter:!0,selectionOffset:[2,1],shortcut:"k"}],u=/\n\s*-\s.+$/,p=/\n(\s*)(\d+)\.\s.+$/,f=/\n\s*(-|\d+\.)\s*$/,b=/\n\s*\d\.\s*$/;class g extends s.a{constructor(...e){super(...e),c(this,"state",{active:this.props.initiallyActive}),c(this,"focusPosition",this.props.focusPosition),c(this,"textarea",Object(s.g)())}static makePrettier(e){let t;const n=new Promise(e=>t=e),s=function(e,t,n){if(e!==t)throw new TypeError("Private static access of wrong provenance");return n.value}(this,g,m).then(()=>new Promise((t,n)=>{h.onmessage=({data:e})=>{t(e)},h.onmessageerror=n,h.onerror=n,h.postMessage(e)})).finally(t);return function(e,t,n,s){if(e!==t)throw new TypeError("Private static access of wrong provenance");if(!n.writable)throw new TypeError("attempted to set read only private field");n.value=s}(this,g,m,n),s}getCaretPosition(e){if(window.getSelection){const{anchorNode:e,anchorOffset:t}=window.getSelection();this.focusPosition={text:e.textContent,offset:t}}}handleCommand(e){return t=>{const{current:n}=this.textarea;if(!n)return;const{selectionStart:s,selectionEnd:i,value:r}=n,o=e.charBefore||e.char||"",a=e.charAfter||e.char||"";if(n.value=r.substring(0,s)+o+r.substring(s,i)+a+r.substring(i),e.selectionAfter)if(e.selectionOffset){const[t,s]=e.selectionOffset;n.setSelectionRange(i+o.length+t,i+o.length+a.length-s)}else n.setSelectionRange(i+a.length,i+a.length);else n.setSelectionRange(s+o.length,i+o.length);this.props.onChange({target:n}),n.focus()}}helper(e){const{value:t,selectionStart:n,selectionEnd:s}=e.target,i=t.lastIndexOf("\n",n-1),r=t.indexOf("\n",s-1),o=t.substring(~i?i:0,~r?r:void 0);if(13===e.keyCode)if(u.test(o))e.preventDefault(),e.target.setRangeText("\n- ",n,s,"end");else if(p.test(o)){e.preventDefault();const[t,i,r]=o.match(p);e.target.setRangeText(`\n${i}${Number(r)+1}. `,n,s,"end")}else f.test(o)&&e.target.setRangeText("\n",n-3,s,"end");else 9===e.keyCode&&(f.test(o)?(e.preventDefault(),e.target.setRangeText("  - ",n-2-b.test(o),s,"end")):0===o.trim().length&&(e.preventDefault(),e.target.setRangeText(" > ",n,s,"end")))}makePrettier(e){const{current:t}=this.textarea;if(t){const{value:e}=t;this.constructor.makePrettier(e).then(e=>{t.value=e,this.props.onChange({target:t})}).catch(console.warn)}}componentDidMount(){if(this.props.initiallyActive&&this.props.initialFocus){const{current:e}=this.textarea,{text:t,start:n,end:s}=this.props.initialFocus,i=e.value.indexOf(t,n)-n;e.setSelectionRange(i+n,i+s),requestAnimationFrame(()=>e.focus())}}componentDidUpdate(){if(this.focusPosition&&this.textarea.current){const{current:e}=this.textarea,t=e.value.lastIndexOf(this.focusPosition.text)+this.focusPosition.offset;e.setSelectionRange(t,t),this.focusPosition=null}}render(){return this.state.active?Object(s.h)("fieldset",{className:"markdown-editor"},Object(s.h)("legend",null,"Markdown editor"),Object(s.h)("p",null,Object(s.h)("button",{hidden:!0,type:"button",onClick:()=>{var e;return null===(e=this.textarea.current)||void 0===e?void 0:e.focus()}}),d.map(e=>Object(s.h)("button",{onClick:this.handleCommand(e),accesskey:e.shortcut,type:"button"},Object(s.h)(i.a,{icon:e.label})))," | ",Object(s.h)("button",{accesskey:"s",onClick:()=>this.setState({active:!1})},Object(s.h)(i.a,{icon:r.h})," Preview")),Object(s.h)("p",null,Object(s.h)("textarea",l({},this.props,{ref:this.textarea,onKeyDown:this.helper.bind(this),onBlur:this.makePrettier.bind(this),rows:"10",cols:"50"})))):this.props.value?Object(s.h)(o.a,{content:this.props.value,attributes:{contenteditable:"true",className:"editable-markdown-preview",onBlur:this.getCaretPosition.bind(this),onClick:e=>{e.stopImmediatePropagation(),this.setState({active:!0})}}}):Object(s.h)("p",{onClick:e=>{e.stopImmediatePropagation(),this.setState({active:!0})}},Object(s.h)("em",{style:{fontSize:"smaller"}},"Empty section, click to add content."))}}var m={writable:!0,value:Promise.resolve()}},42:function(e,t,n){e.exports=function(){return new Worker(n.p+"adfb402c072b1a1540cb.worker.js")}}}]);