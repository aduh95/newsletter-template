(window.webpackJsonp=window.webpackJsonp||[]).push([[3,22,23],{39:function(t,e,s){"use strict";s.r(e),s.d(e,"default",(function(){return a}));var n=s(8);const i=/\/search#documentUUID\/([a-f0-9\-]+)\/(.+)$/;function a(t){if(i.test(t)&&n.default.getHostNameRegExp().test(t)){const[e,s,a]=i.exec(t),r=new URL("/search",n.default.getAsURL());return r.searchParams.set("documentUUID",s),r.searchParams.set("title",a),r.toString()}try{t=new URL(t).toString()}catch{}return t}},41:function(t,e,s){"use strict";s.r(e),s.d(e,"default",(function(){return a}));var n=s(0),i=s(12);class a extends n.a{handleDrag({currentTarget:t},e){const s=Array.from(t.parentNode.children),n=s.indexOf(t),i=s.indexOf(e);this.props.handleReOrder(n,i)}render(){const t=this.props.content||[];return Object(n.h)("ol",{className:"ordered-list"},t.concat([{}]).map(({label:e,href:s},a)=>Object(n.h)("li",{draggable:a<t.length,onDragStart:Object(i.a)(this.handleDrag.bind(this)),key:a},Object(n.h)("input",{name:"label",value:e||"",placeholder:"Link label",onChange:t=>this.props.handleChange(t,a)}),Object(n.h)("input",{name:"href",value:s||"",placeholder:"Link URL",onChange:t=>this.props.handleChange(t,a),type:"url"}))))}}},46:function(t,e,s){"use strict";s.r(e),s.d(e,"default",(function(){return m}));var n=s(0),i=s(41),a=s(65),r=s(61),o=s(39);function l(t,e){if(!Object.prototype.hasOwnProperty.call(t,e))throw new TypeError("attempted to use private field on non-instance");return t}var c=0;function h(t){return"__private_"+c+++"_"+t}function u(t,e){const{target:s}=e,{name:n,value:i}=s;t({...this.props,[n]:i})}class d extends n.a{constructor(...t){super(...t),Object.defineProperty(this,p,{writable:!0,value:u.bind(this,this.props.onChange)}),Object.defineProperty(this,b,{writable:!0,value:this.disableIllustration.bind(this)}),Object.defineProperty(this,f,{writable:!0,value:this.switchToImage.bind(this)}),Object.defineProperty(this,g,{writable:!0,value:this.switchToVideo.bind(this)})}static getDerivedStateFromProps({src:t}){return{noIllustration:!t}}disableIllustration(t){this.props.onChange({src:void 0,alt:void 0,isVideo:void 0})}switchToVideo(t){this.props.onChange({src:"about:blank",alt:void 0,isVideo:!0}),requestAnimationFrame(()=>t.target.form.elements.src.focus())}switchToImage(t){this.props.onChange({src:"about:blank",alt:"",isVideo:!1}),requestAnimationFrame(()=>t.target.form.elements.src.focus())}render(){return Object(n.h)("fieldset",null,Object(n.h)("legend",null,"Illustration"),"Illustration type: ",Object(n.h)("label",null,Object(n.h)("input",{onChange:l(this,b)[b],name:"isVideo",type:"radio",value:"noIllustration",checked:this.state.noIllustration})," No illustration"),Object(n.h)("label",null,Object(n.h)("input",{onChange:l(this,f)[f],name:"isVideo",type:"radio",value:"false",checked:!this.state.noIllustration&&!this.props.isVideo})," Image"),Object(n.h)("label",null,Object(n.h)("input",{onChange:l(this,g)[g],name:"isVideo",type:"radio",value:"true",checked:!this.state.noIllustration&&this.props.isVideo})," Video"),this.state.noIllustration?null:Object(n.h)("label",{className:"full-size"},this.props.isVideo?"Video":"Image"," URL: ",Object(n.h)("input",{onChange:l(this,p)[p],name:"src",type:"url",value:this.props.src})),this.state.noIllustration||this.props.isVideo?null:Object(n.h)("label",{className:"full-size"},"Image description: ",Object(n.h)("input",{onChange:l(this,p)[p],name:"alt",value:this.props.alt,placeholder:"Mandatory description of the image",required:!0})))}}var p=h("handleChange"),b=h("disableIllustration"),f=h("switchToImage"),g=h("switchToVideo");class m extends n.a{constructor(...t){super(...t),this.form=Object(n.g)(),Object.defineProperty(this,v,{writable:!0,value:u.bind(this,this.setState.bind(this))}),Object.defineProperty(this,O,{writable:!0,value:({target:{name:t,checked:e}})=>l(this,v)[v]({target:{name:t,value:e}})}),Object.defineProperty(this,j,{writable:!0,value:this.handleSubmit.bind(this)}),Object.defineProperty(this,y,{writable:!0,value:this.handleListChange.bind(this)}),Object.defineProperty(this,w,{writable:!0,value:this.handleListReOrder.bind(this)}),Object.defineProperty(this,k,{writable:!0,value:({isVideo:t,src:e,alt:s})=>this.setState({isVideo:t,illustration:e,illustrationDescription:s})}),this.state={type:this.props.type,title:this.props.title,description:this.props.description,isMain:!!this.props.isMain,isVideo:!!this.props.isVideo,illustration:this.props.illustration||null,illustrationDescription:this.props.illustrationDescription,links:Array.isArray(this.props.links)?this.props.links:[]}}componentDidMount(){this.update()}componentDidUpdate(t){this.update(t)}update(t={}){const{current:e}=this.form;if(e&&t.focus!==this.props.focus){const t=this.props.focus,s=null==t?void 0:t.match(/^(.+)\[(\d+)\]$/),n=s?e.querySelectorAll("[name=".concat(s[1],"]")).item(s[2]):e.querySelector("[name=".concat(t,"]"));n&&requestAnimationFrame(()=>{if(this.props.focusOffset){let t=this.props.focusText?n.value.indexOf(this.props.focusText,this.props.focusOffset[0])-this.props.focusOffset[0]:0;n.setSelectionRange(...this.props.focusOffset.map(e=>e+t))}n.focus()})}}handleListChange(t,e){const{name:s,value:n}=t.target,{links:i}=this.state;e===i.length?i.push({[s]:n}):i[e][s]=n,this.setState({links:i})}handleSubmit(){const t={...this.state};if(Array.isArray(this.state.links)&&(t.links=this.state.links.filter(({label:t,href:e})=>t||e).map(({label:t,href:e})=>({label:t||"[Link]",href:Object(o.default)(e)||"about:blank"}))),t.illustration)if(t.isVideo){const e=new URL(t.illustration);/youtube(\.com)?$/.test(e.hostname)?t.illustration="https://www.youtube.com/embed/"+e.searchParams.get("v"):"youtube.be"===e.hostname?t.illustration="https://www.youtube.com/embed/"+e.pathname.substring(1):e.hostname.endsWith("vimeo.com")&&(t.illustration="https://player.vimeo.com/video/"+e.pathname.substring(1,e.pathname.indexOf("/",2)))}else t.illustration=Object(o.default)(t.illustration);requestAnimationFrame(()=>this.props.saveState(t))}handleListReOrder(t,e){const s=this.state.links;let n=[];-1===e?n=n.concat(s.slice(0,t),s.slice(t+1)):t<e?n=n.concat(s.slice(0,t),s.slice(t+1,e),s.slice(t,1),s.slice(e)):t>e&&(n=n.concat(s.slice(0,e),s.slice(t,t+1),s.slice(e,t),s.slice(t+1))),t!==e&&this.setState({links:n})}render(){return Object(n.h)(r.a,{onClose:this.props.resetState},Object(n.h)("form",{method:"dialog",ref:this.form,onSubmit:l(this,j)[j]},Object(n.h)("div",null,Object(n.h)("label",{className:"full-size"},"Title: ",Object(n.h)("input",{name:"title",required:!0,value:this.state.title,onChange:l(this,v)[v]})),Object(n.h)("label",null,"Featured article: ",Object(n.h)("input",{name:"isMain",checked:this.state.isMain,type:"checkbox",onChange:l(this,O)[O]})),Object(n.h)(d,{isVideo:this.state.isVideo,src:this.state.illustration,alt:this.state.illustrationDescription,onChange:l(this,k)[k]}),Object(n.h)("label",null,"Text: ",Object(n.h)(a.a,{name:"description",value:this.state.description,onChange:l(this,v)[v],initiallyActive:"description"===this.props.focus})),Object(n.h)(i.default,{content:this.state.links,handleChange:l(this,y)[y],handleReOrder:l(this,w)[w]}),Object(n.h)("button",{type:"submit"},"Save"),Object(n.h)("button",{type:"reset",onClick:this.props.resetState},"Cancel"))))}}var v=h("handleChange"),O=h("handleCheckboxChange"),j=h("handleSubmit"),y=h("handleListChange"),w=h("handleListReOrder"),k=h("handleIllustrationChange")},59:function(t,e,s){"use strict";s.d(e,"a",(function(){return c}));var n=s(0),i=s(60);function a(){return(a=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var s=arguments[e];for(var n in s)Object.prototype.hasOwnProperty.call(s,n)&&(t[n]=s[n])}return t}).apply(this,arguments)}function r(t,e){if(!Object.prototype.hasOwnProperty.call(t,e))throw new TypeError("attempted to use private field on non-instance");return t}var o=0;const l=new(s.n(i).a);class c extends n.a{constructor(...t){super(...t),this.state={loading:!0}}static translate(t){let e;const s=new Promise(t=>e=t),n=r(this,h)[h].then(()=>new Promise((e,s)=>{l.onmessage=({data:t})=>{e(t)},l.onmessageerror=s,l.onerror=s,l.postMessage(t)})).finally(e);return r(this,h)[h]=s,n}componentDidMount(){this.translate()}componentDidUpdate(t){t.content!==this.props.content&&this.translate()}translate(){this.constructor.translate(this.props.content).then(t=>{this.setState({loading:!1,html:t})}).catch(t=>{console.error(t),this.setState({loading:!1,html:"<div data-ignore class='error'>Error when rendering markdown content</div>"})})}render(){return this.state.loading?Object(n.h)("p",{"data-ignore":!0},"Loading..."):Object(n.h)("output",a({"data-contents":!0,dangerouslySetInnerHTML:{__html:this.state.html}},this.props.attributes))}}var h="__private_"+o+++"_"+"translationJobs";Object.defineProperty(c,h,{writable:!0,value:Promise.resolve()})},60:function(t,e,s){t.exports=function(){return new Worker(s.p+"68d89b06e5bbcff2ad92.worker.js")}},61:function(t,e,s){"use strict";var n=s(0),i=s(2);const a="HTMLDialogElement"in window;var r=t=>a?Promise.resolve():Promise.all([s.e(26).then(s.bind(null,69)),s.e(14).then(s.t.bind(null,70,7))]).then(e=>e[0].default.registerDialog(t));s.d(e,"a",(function(){return l}));const o=t=>t.stopPropagation();class l extends n.a{constructor(...t){super(...t),this.dialog=Object(n.g)()}componentDidMount(){this.update()}componentDidUpdate(){this.update()}update(){const{current:t}=this.dialog;r(t).then(()=>t&&!t.open&&t.showModal())}render(){return Object(i.c)(Object(n.h)("dialog",{"data-do-not-export":!0,"data-ignore":!0,onClose:this.props.onClose,onClick:o,ref:this.dialog},this.props.children),document.body)}}},63:function(t,e,s){t.exports=function(){return new Worker(s.p+"949e7fc7c91b7ff54d3d.worker.js")}},64:function(t,e,s){},65:function(t,e,s){"use strict";var n=s(0),i=s(4),a=s(5),r=s(59),o=s(63),l=s.n(o);const c=Symbol("ul"),h=Symbol("ol"),u={[c]:/^(\s*)([-*]\s)/,[h]:/^(\s*)(\d+\.\s)/},d={[c]:"- ",[h]:"1. "},p=/^(\s*)(\d+\.|-|\*)\s/,b="\n";s(64);function f(){return(f=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var s=arguments[e];for(var n in s)Object.prototype.hasOwnProperty.call(s,n)&&(t[n]=s[n])}return t}).apply(this,arguments)}function g(t,e){if(!Object.prototype.hasOwnProperty.call(t,e))throw new TypeError("attempted to use private field on non-instance");return t}s.d(e,"a",(function(){return C}));var m=0;function v(t){return"__private_"+m+++"_"+t}const O=new l.a,j=[{label:a.a,char:"**",shortcut:"b",help:"Bold"},{label:a.g,char:"_",shortcut:"i",help:"Italic"},{label:a.j,listType:c,help:"Unorded list"},{label:a.i,listType:h,help:"Ordered list"},{label:a.h,charBefore:"[",charAfter:"](https://)",selectionAfter:!0,selectionOffset:[2,1],shortcut:"k",help:"Hypertext link"}],y=/\n(\s*[-*])\s.+$/,w=/\n(\s*)(\d+)\.\s.+$/,k=/\n\s*(-|\d+\.)\s*$/,x=/\n\s*\d+\.\s*$/,P="md-command";class C extends n.a{constructor(...t){super(...t),this.state={active:this.props.initiallyActive},this.focusPosition=this.props.focusPosition,this.textarea=Object(n.g)(),Object.defineProperty(this,T,{writable:!0,value:this.helper.bind(this)}),Object.defineProperty(this,R,{writable:!0,value:this.makePrettier.bind(this)}),Object.defineProperty(this,I,{writable:!0,value:{contenteditable:"true",className:"editable-markdown-preview",onBlur:this.getCaretPosition.bind(this),onClick:t=>{t.stopImmediatePropagation(),this.setState({active:!0})}}}),Object.defineProperty(this,D,{writable:!0,value:Object(n.h)("p",null,Object(n.h)("button",{hidden:!0,type:"button",onClick:()=>{var t;return null===(t=this.textarea.current)||void 0===t?void 0:t.focus()}}),j.map(t=>Object(n.h)("button",{onClick:this.handleCommand(t),accesskey:t.shortcut,type:"button",className:P,title:t.help},Object(n.h)(i.a,{icon:t.label})))," | ",Object(n.h)("button",{className:"md-preview",accesskey:"s",onClick:()=>this.setState({active:!1})},Object(n.h)(i.a,{icon:a.d})))})}static makePrettier(t){let e;const s=new Promise(t=>e=t),n=g(this,S)[S].then(()=>new Promise((e,s)=>{O.onmessage=({data:t})=>{e(t)},O.onmessageerror=s,O.onerror=s,O.postMessage(t)})).finally(e);return g(this,S)[S]=s,n}getCaretPosition(t){if(window.getSelection){const{anchorNode:t,anchorOffset:e}=window.getSelection();this.focusPosition={text:t.textContent,offset:e}}}handleCommand(t){return e=>{const{current:s}=this.textarea;if(s){if(t.listType)!function(t,e){const{selectionStart:s,selectionEnd:n,value:i}=e,a=d[t],r=u[t],o=Math.max(0,i.lastIndexOf(b,s-1)),l=function(t,e,s){const n=t.indexOf(e,s);return-1===n?t.length:n}(i,b,n);if(s===n){const t=i.substring(o,l);if(n===i.length||i.charAt(s)===b)if(0===s||i.charAt(s-1)===b)e.setRangeText(t+b+a,o,l,"end");else if(p.test(t)){const[s,n]=t.match(p);e.setRangeText(t+b+n+"    "+a,o,l,"end")}else e.setRangeText(b+a+t,o,l,"end");else r.test(t)?e.setRangeText(t.replace(r,""),o,l):p.test(t)?e.setRangeText(t.replace(p,(t,e)=>e+a),o,l):e.setRangeText(a+t,o,l)}else{const t=i.substring(o,l).split(b).filter(String);t.reduce((t,e)=>t&&r.test(e),!0)?e.setRangeText(t.map(t=>t.replace(r,"")).join(b),o,l):t.reduce((t,e)=>t&&p.test(e),!0)?e.setRangeText(t.map(t=>t.replace(p,(t,e)=>e+a)).join(b),o,l):e.setRangeText(t.map(t=>a+t).join(b),o,l)}}(t.listType,s);else{const{selectionStart:e,selectionEnd:n,value:i}=s,a=t.charBefore||t.char||"",r=t.charAfter||t.char||"",o=i.substring(e-a.length,e)===a&&i.substring(n,n+r.length)===r;if(s.value=o?i.substring(0,e-a.length)+i.substring(e,n)+i.substring(n+r.length):i.substring(0,e)+a+i.substring(e,n)+r+i.substring(n),t.selectionAfter)if(t.selectionOffset){const[e,i]=t.selectionOffset;s.setSelectionRange(n+a.length+e,n+a.length+r.length-i)}else s.setSelectionRange(n+r.length,n+r.length);else o?s.setSelectionRange(e-a.length,n-a.length):s.setSelectionRange(e+a.length,n+a.length)}this.props.onChange({target:s}),s.focus()}}}helper(t){const{value:e,selectionStart:s,selectionEnd:n}=t.target,i=e.lastIndexOf("\n",s-1),a=e.indexOf("\n",n-1),r=e.substring(~i?i:0,~a?a:void 0);if(13===t.keyCode)if(y.test(r)){t.preventDefault();const[e,i]=r.match(y);t.target.setRangeText("\n".concat(i," "),s,n,"end")}else if(w.test(r)){t.preventDefault();const[e,i,a]=r.match(w);t.target.setRangeText("\n".concat(i).concat(Number(a)+1,". "),s,n,"end")}else k.test(r)&&t.target.setRangeText("\n",s-3,n,"end");else 9===t.keyCode&&(k.test(r)?(t.preventDefault(),t.target.setRangeText("  - ",s-2-x.test(r),n,"end")):0===r.trim().length&&(t.preventDefault(),t.target.setRangeText(" > ",s,n,"end")))}makePrettier(t){var e;const{current:s}=this.textarea,{relatedTarget:n}=t;if(s&&!(null==n?void 0:null===(e=n.classList)||void 0===e?void 0:e.contains(P))){const{value:t}=s;this.constructor.makePrettier(t).then(t=>{s.value=t,this.props.onChange({target:s})}).catch(console.warn)}}componentDidMount(){if(this.props.initiallyActive&&this.props.initialFocus){const{current:t}=this.textarea,{text:e,start:s,end:n}=this.props.initialFocus,i=t.value.indexOf(e,s)-s;t.setSelectionRange(i+s,i+n),requestAnimationFrame(()=>t.focus())}}componentDidUpdate(){if(this.focusPosition&&this.textarea.current){const{current:t}=this.textarea,e=t.value.lastIndexOf(this.focusPosition.text)+this.focusPosition.offset;t.setSelectionRange(e,e),this.focusPosition=null}}render(){return this.state.active?Object(n.h)("fieldset",{className:"markdown-editor"},Object(n.h)("legend",null,"Markdown editor"),g(this,D)[D],Object(n.h)("p",null,Object(n.h)("textarea",f({},this.props,{ref:this.textarea,onKeyDown:g(this,T)[T],onBlur:g(this,R)[R],rows:"10",cols:"50"})))):this.props.value?Object(n.h)(r.a,{content:this.props.value,attributes:g(this,I)[I]}):Object(n.h)("p",{onClick:t=>{t.stopImmediatePropagation(),this.setState({active:!0})}},Object(n.h)("em",{style:{fontSize:"smaller"}},"Empty section, click to add content."))}}var S=v("prettierJobs"),T=v("helper"),R=v("makePrettier"),I=v("markdownContentAttributes"),D=v("actionBar");Object.defineProperty(C,S,{writable:!0,value:Promise.resolve()})}}]);